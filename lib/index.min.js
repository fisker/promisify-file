!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((r=r||self).PromisifyFile={})}(this,function(r){"use strict";function t(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function e(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable}))),o.forEach(function(e){t(r,e,n[e])})}return r}var n=Object.defineProperties;function o(r,t){for(var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{configurable:!0,writable:!0,enumerable:!0},a={},i=Object.keys(t),u=0;u<i.length;u++){var c=i[u];a[c]=e({value:t[c]},o)}return n(r,a)}var a=new Function("return this")(),i=a.URL||a.webkitURL,u=a.ArrayBuffer,c=a.atob,f=a.Blob,l=a.createImageBitmap,s=a.DataView,v=a.DOMParser,h=a.document,y=a.fetch,d=a.File,p=a.Image,m=a.OffscreenCanvas,g=(a.Promise,a.Int8Array),b=a.Uint8Array,w=a.Uint8ClampedArray,A=a.Int16Array,P=a.Uint16Array,x=a.Int32Array,j=a.Uint32Array,B=a.Float32Array,L=a.Float64Array,O=a.XMLSerializer;function S(r){return"function"==typeof r}function E(r){return null!==r&&("object"==typeof r||S(r))}var M=function(){try{return E(new d([],""))}catch(r){return!1}}(),T=S(m),U=function(){try{var r=new u,t=new s(r);return E(new f([t]))}catch(r){return!1}}();var R=M?function(r,t,e){return new d(r,t,e)}:function(r,t,e){var n=new f(r,e);return n.name=t,n.lastModified=e.lastModified||Date.now(),n};function C(r){return t=function(){for(var t=this,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return r.call.apply(r,[t].concat(n))},function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];try{return Promise.resolve(t.apply(this,r))}catch(r){return Promise.reject(r)}};var t}function D(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.$store.blob;return r=e({},t,r),new f([t],r)}var $=C(D),F="application/xml",I="image/svg+xml",H="text/html",X={none:"",text:"text",json:"json",document:"document"},q="end",k="UTF-8",z="error occurred during loading image",N="XMLHttpRequest timeout",W="error occurred during XMLHttpRequest";function J(r,t){for(var e=arguments.length,n=new Array(e>2?e-2:0),o=2;o<e;o++)n[o-2]=arguments[o];return function(){for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];var i=r===q?[].concat(o,n):[].concat(n,o);return t.apply(this,i)}}var V=J.bind(null,"start")(J,q);function _(r,t){var e=(new v).parseFromString(r,t);return function(r){var t=r.getElementsByTagName("parsererror")[0];if(t)throw new Error(t.innerText||t.textContent)}(e),e}var G=function(r){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return Promise.resolve(r.apply(this,t))}catch(r){return Promise.reject(r)}}}(function(r,t){var e,n,o;return r=r||this.$options.encoding,t=t||this.$store.blob.type,e=this.text(r),n=function(r){return _(r,t)},o?n?n(e):e:(e&&e.then||(e=Promise.resolve(e)),n?e.then(n):e)}),K=V(G,F),Q=V(G,I),Y=V(G,H),Z=new Function("return this")(),rr=Z.FileReader,tr=Z.Promise,er=Array.prototype.slice,nr=["ArrayBuffer","Text","DataURL","BinaryString"];function or(r){var t=er.call(arguments,1);return new tr(function(e,n){var o=new rr;o.addEventListener("load",function(){return e(o.result)}),o.addEventListener("error",function(){return n(o.error)}),r.apply(o,t)})}function ar(){}for(var ir=0;ir<nr.length;ir++){var ur="readAs".concat(nr[ir]),cr=or.bind(null,rr.prototype[ur]);ar.prototype[ur]=cr,ar[ur]=cr}var fr={arrayBuffer:ar.readAsArrayBuffer,text:ar.readAsText,dataURL:ar.readAsDataURL,binaryString:ar.readAsBinaryString};function lr(r){var t=fr[r];return function(e){e=String(e||this.$options.encoding||k).toUpperCase();var n="text"===r?r:"".concat(r,".").concat(e),o=this.$store;return o[n]||(o[n]=t(o.blob,e)),o[n]}}var sr=lr("arrayBuffer"),vr=lr("text"),hr=lr("dataURL"),yr=lr("binaryString");function dr(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.$store.blob;return r=r||n.name,t=e({},n,t),R([n],r,t)}var pr=C(dr);function mr(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];return l.apply(void 0,[this.$store.blob].concat(t))}var gr=C(mr);var br=T?function(r,t){return new m(r,t).getContext("2d")}:function(r,t){var e=h.createElement("canvas");return e.width=r,e.height=t,e.getContext("2d")};function wr(r){var t=br(r.naturalWidth||r.width,r.naturalHeight||r.height);return t.drawImage(r,0,0),t}var Ar=function(r){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return Promise.resolve(r.apply(this,t))}catch(r){return Promise.reject(r)}}}(function(r,t,e,n){var o,a,i;return o=this.image(),a=function(o){return function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.naturalWidth||r.width,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r.naturalHeight||r.height;return wr(r).getImageData(t,e,n,o)}(o,r,t,e,n)},i?a?a(o):o:(o&&o.then||(o=Promise.resolve(o)),a?o.then(a):o)});function Pr(r){return function(){for(var t=this,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return new Promise(function(e,o){var a=r.call.apply(r,[t,e,o].concat(n));void 0!==a&&e(a)})}}function xr(r,t,e){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r.addEventListener(t,e,n)}var jr=Pr(function(r,t,e){if(e.naturalWidth)return r(e);xr(e,"load",function(){r(e)}),xr(e,"error",function(){t(new Error(z))})});function Br(r){var t=new p;return t.src=r,jr(t)}var Lr=function(r){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return Promise.resolve(r.apply(this,t))}catch(r){return Promise.reject(r)}}}(function(){var r,t,e;return r=this.url(),t=Br,e?t?t(r):r:(r&&r.then||(r=Promise.resolve(r)),t?r.then(t):r)});var Or=function(r){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return Promise.resolve(r.apply(this,t))}catch(r){return Promise.reject(r)}}}(function(r,t){var e,n,o;return e=this.text(r||this.$options.encoding),n=function(r){return JSON.parse(r,t)},o?n?n(e):e:(e&&e.then||(e=Promise.resolve(e)),n?e.then(n):e)});function Sr(r){return t=function(t,e,n){var o,a,i;return o=this.arrayBuffer(),a=function(t){return new r(t,e,n)},i?a?a(o):o:(o&&o.then||(o=Promise.resolve(o)),a?o.then(a):o)},function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];try{return Promise.resolve(t.apply(this,r))}catch(r){return Promise.reject(r)}};var t}var Er=Sr(s),Mr=Sr(B),Tr=Sr(L),Ur=Sr(A),Rr=Sr(x),Cr=Sr(g),Dr=Sr(P),$r=Sr(j),Fr=Sr(b),Ir=Sr(w);function Hr(){return i.createObjectURL(this.$store.blob)}var Xr=C(Hr),qr=Object.freeze({blob:$,blobSync:D,document:G,xml:K,svg:Q,html:Y,arrayBuffer:sr,text:vr,dataURL:hr,binaryString:yr,fileSync:dr,file:pr,imageBitmap:gr,imageBitmapSync:mr,imageData:Ar,image:Lr,json:Or,dataView:Er,float32Array:Mr,float64Array:Tr,int16Array:Ur,int32Array:Rr,int8Array:Cr,uint16Array:Dr,uint32Array:$r,uint8Array:Fr,uint8ClampedArray:Ir,url:Xr,urlSync:Hr}),kr=function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var n=t,o=e.type||t.type,a=e.name||t.name,i=e.lastModified||t.lastModified;o===t.type&&a===t.name&&i===t.lastModified||(n=a?R([t],a,{type:o,lastModified:i}):new f([t],{type:o})),this.$store={original:t,blob:n},this.$options=e};function zr(r){return E(r)&&S(r.then)}o(kr.prototype,qr);var Nr=Object.prototype.toString;function Wr(r){return Nr.call(r).slice(8,-1)}function Jr(r){switch(r.responseType){case X.none:case X.text:return r.responseText;case X.json:return JSON.stringify(r.response);case X.document:return r.responseXML;default:return r.response}}var Vr=Pr(function(r,t,e){4!==e.readyState?(xr(e,"load",function(){r(Jr(e))}),xr(e,"error",function(){t(new Error(W))}),xr(e,"timeout",function(){t(new Error(N))})):r(Jr(e))});var _r=Pr(function(r,t,e){return e.result?r(e.result):e.error?t(e.error):(xr(e,"load",function(){r(e.result)}),void xr(e,"error",function(){t(e.error)}))});function Gr(r,t){var e=c(r.split(",")[1]),n=b.from(e,function(r){return r.charCodeAt(0)});return new f([n],{type:t})}var Kr=Pr(function(r,t,e,n,o){return e.toBlob?e.toBlob(r,n,o):e.convertToBlob?r(e.convertToBlob(n,o)):r(Gr(e.toDataURL(n,o)))});function Qr(r){return E(r)&&function(r){return E(r)&&S(r.getContext)}(r.canvas)}var Yr=/^data:(.*?)?;base64,(.+)$/;function Zr(r){return E(r)&&function(r){return E(r)&&"ArrayBuffer"===Wr(r)}(r.buffer)}function rt(r,t){var e=function(){return rt(t)};if(zr(r))return r.then(e);var n,o,a,i=Wr(r);if("Blob"===i||"File"===i)return r;if("XMLHttpRequest"===i)return Vr(r).then(e);if("HTMLImageElement"===i)return jr(r).then(wr).then(e);if("ImageBitmap"===i)return e(wr(r));if("ImageData"===i)return e(function(r){var t=br(r.width,r.height);t.putImageData(r,0,0)}(r));if("FileReader"===i)return _r(r).then(e);if(E(n=r)&&S(n.arrayBuffer)&&S(n.blob)&&S(n.formData)&&S(n.json)&&S(n.text))return r.blob();if(function(r){return E(r)&&E(r.documentElement)&&S(r.createElement)}(r))return e((o=r).documentElement.outerHTML||(new O).serializeToString(o));if("HTMLCanvasElement"===i)return Kr(r,t.type,t.quality);if("OffscreenCanvas"===i)return r.convertToBlob(t);if(Qr(r))return e(r.canvas);if(a=r,Yr.test(a))try{var u=Gr(r);if(u)return u}catch(r){}return/^(?:blob|data):/.test(r)?y(r).then(e):!U&&Zr(r)?e(r.buffer):new f([r],t)}function tt(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=rt(r,t);return(zr(e)?e:Promise.resolve(e)).then(function(){return new kr(e,t)})}o(kr,{from:tt}),r.default=kr,r.from=tt,Object.defineProperty(r,"__esModule",{value:!0})});
//# sourceMappingURL=index.min.js.map
